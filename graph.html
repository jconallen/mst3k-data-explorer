<!DOCTYPE html>
<html lang="en">

<head>
    <title>Vis Network | Events | Interaction events</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
        integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/bootstrap-table.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/todc-bootstrap/3.3.7-3.3.13/js/bootstrap.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-modal/2.2.6/js/bootstrap-modalmanager.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/bootstrap-table.min.js"></script>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js" type="text/javascript"></script>

    <style type="text/css">
        #mynetwork {
            width: 1200px;
            height: 800px;
            border: 1px solid lightgray;
        }
    </style>

</head>

<body>

    <div class="container">

        <p>
            Create a simple network with some nodes and edges. Some of the events are
            logged in the console in improve readability.
        </p>

        <div id="progress" class="container">
            <div class="row">
                <div class="col-sm-3">
                    <div class="progress">
                        <div id="progressBar" class="progress-bar" role="progressbar"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container" id="mynetwork"></div>

    </div>

    <div class="container">
        <h2 id="eventSpanHeading"></h2>
        <pre id="eventSpanContent"></pre>

    </div>


    <script type="text/javascript">
        // create an array with nodes

        var nodes = null;
        var edges = null;

        $( document ).ready(function() {

            $.ajax({
		       url: "data/nodes.json",
		       dataType: 'json',
		       success: function(data){
                nodes = new vis.DataSet(data);
                dataAdded();
               },
		       crossDomain:true
		    });

            $.ajax({
		       url: "data/edges.json",
		       dataType: 'json',
		       success: function(data){
                edges = new vis.DataSet(data);
                dataAdded();
               },
		       crossDomain:true
		    });
        });

        function dataAdded(){
            if( nodes != null && edges != null ){
                var data = {
                    nodes: nodes,
                    edges: edges,
                };
                buildGraph(data)
            }
        }

        function buildGraph(data){
            var container = document.getElementById("mynetwork");
            var options = {
                interaction: { hover: true },
                manipulation: { enabled: false },
                layout: {
                    randomSeed: undefined,
                    improvedLayout:false,
                    clusterThreshold: 150,
                    hierarchical: {
                        enabled:false,
                        levelSeparation: 150,
                        nodeSpacing: 100,
                        treeSpacing: 200,
                        blockShifting: true,
                        edgeMinimization: true,
                        parentCentralization: true,
                        direction: 'UD',        // UD, DU, LR, RL
                        sortMethod: 'hubsize',  // hubsize, directed
                        shakeTowards: 'leaves'  // roots, leaves
                    }
                }
            };

            var network = new vis.Network(container, data, options);

            network.on("stabilizationProgress", function (params) {
                var widthFactor = parseInt( params.iterations / params.total * 100 );

                $("#progressBar")
                    .css("width", widthFactor + "%")
                    .attr("aria-valuenow", widthFactor)
                    .text(widthFactor + "%");
            });

            network.once("stabilizationIterationsDone", function () {
                $("#progressBar")
                    .css("width", "100%")
                    .attr("aria-valuenow", 100)
                    .text("100% progress");

                setTimeout(function () {
                    $('#progressBar').addClass('.d-none');
                    console.log("hiding")
                }, 1000);
            });

            network.on("click", function (params) {
                params.event = "[original event]";
                document.getElementById("eventSpanHeading").innerText = "Click event:";
                document.getElementById("eventSpanContent").innerText = JSON.stringify(
                    params,
                    null,
                    4
                );
                console.log(
                    "click event, getNodeAt returns: " +
                    this.getNodeAt(params.pointer.DOM)
                );
            });
        }


    </script>
</body>

</html>